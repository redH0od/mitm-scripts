ARP спуффинг манипулирует протоколом ARP (Address Resolution Protocol), который используется для разрешения IP-адресов в MAC-адреса. Злоумышленник может перехватывать траффик пользователя на себя, тем самым он может получить все данные, идущие от пользователя, потом изменять или подменять их. Атака является опасной в сетях с использованием протокола Ethernet, так как ARP работает в этой сети без проверки подлинности.

В ARP-спуффинге злоумышленник отправляет в сеть фальшивые ARP-ответы, утверждая, что его MAC-адрес соответствует IP-адресу другого устройства, например, шлюза по умолчанию. Это приводит к перехвату трафика, DoS (отказу в обслуживании) и  самой MITM атаке за счет подмены ARP-таблицы.

Пример атаки:
Представим, что вы мамкин хакер и хотите затроллить своего соседа по квартире (ну насолил он вам, бывает). Вы пользуетесь одним и тем же интернетом. Отлично, для начала нужно убедиться, что вы подключены к одной сети. Проверяем ipconfig на Windows и ifconfig на Linux-системах соответственно. Находим там шлюз вашего роутера или иного устройства, выполняющего его роль. Проверить работу хоста можно сделать, используя скрипт hostcheck.py из репа. Скрипт посылает один пакет на IP и проверяет наличие ответа. Теперь нужно узнать целевой IP-адрес соседа. Запускаем скрипт localscan.py и сканируем шлюз в нужном диапазоне (/24 в данном случае). Если подключены лишь вы и ваш сосед, то найти IP и MAC-адреса соседа не составит проблемы. Осталось только запустить скрипт arpspf.py и заспуфить соседа. Вводим целевой IP и IP шлюза. Трафик от соседа идет к вам, он не может смотрить Ютуб. Если хотите, можно с помощью утилит на подобии Wireshark или tcpdump просмотреть весь трафик, идущий от соседа к вам и посмотреть что он там пытается отчаянно открыть или ввести.
